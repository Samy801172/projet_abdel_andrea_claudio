<div class="appointments-container">
  <!-- Conteneur principal pour la gestion des rendez-vous -->

  <header class="appointments-header">
    <!-- En-tête contenant le titre et le bouton pour afficher/masquer le formulaire -->
    <h1>Mes Rendez-vous</h1>
    <button class="new-appointment-btn" (click)="toggleAddForm()">
      <!-- Affiche "Fermer" ou "Nouveau Rendez-vous" selon l'état -->
      {{ showAddForm ? 'Fermer' : 'Nouveau Rendez-vous' }}
    </button>
  </header>

  <!-- Formulaire d'ajout/modification des rendez-vous -->
  <div *ngIf="showAddForm" class="appointment-form">
    <form [formGroup]="appointmentForm" (ngSubmit)="submitAppointment()">
      <!-- Sélection du service -->
      <div class="form-group">
        <label for="service">Service</label>
        <select id="service" formControlName="serviceId" required>
          <option value="">Sélectionnez un service</option>
          <option *ngFor="let service of services" [value]="service.id">
            {{ service.name }} (Durée: {{ service.duration }} min)
          </option>
        </select>
      </div>

      <!-- Sélection de la date -->
      <div class="form-group">
        <label for="date">Date</label>
        <input type="date" id="date" formControlName="appointmentDate" required [min]="minDate" (change)="onDateChange()" />
      </div>

      <!-- Sélection de l'heure -->
      <div class="form-group">
        <label for="time">Heure</label>
        <select id="time" formControlName="time" required>
          <option value="">Sélectionnez une heure</option>
          <option *ngFor="let slot of availableTimeSlots" [value]="slot">
            {{ slot }}
          </option>
        </select>
      </div>

      <!-- Champ pour les notes -->
      <div class="form-group">
        <label for="note">Notes</label>
        <textarea id="note" formControlName="note" placeholder="Ajouter des notes..."></textarea>
      </div>

      <!-- Actions du formulaire -->
      <div class="form-actions">
        <button type="submit" [disabled]="!appointmentForm.valid">
          {{ editingAppointment ? 'Modifier' : 'Créer' }}
        </button>
        <button type="button" (click)="toggleAddForm()">Annuler</button>
      </div>
    </form>
  </div>

  <!-- Liste des rendez-vous -->
  <div class="appointments-list">
    <div *ngIf="appointments.length === 0" class="no-data">
      Aucun rendez-vous trouvé.
    </div>
    <div *ngIf="appointments.length > 0" class="appointments-grid">
      <div *ngFor="let appointment of appointments" class="appointment-card">
        <div class="appointment-details">
          <h3>{{ appointment.service?.name }}</h3>
          <p>Date : {{ appointment.appointmentDate | date: 'dd/MM/yyyy' }}</p>
          <p>Heure : {{ appointment.time }}</p>
          <p>Notes : {{ appointment.note || 'Aucune' }}</p>
          <p
            class="status"
            [ngClass]="{
    'text-pending': appointment.status === 'en attente',
    'text-canceled': appointment.status === 'annulé',
    'text-confirmed': appointment.status === 'confirmé'
  }"
          >
            Statut : {{ appointment.status }}
          </p>
        </div>
        <div class="appointment-actions">
          <button (click)="editAppointment(appointment)">Modifier</button>
          <button (click)="cancelAppointment(appointment)">Annuler</button>
        </div>
      </div>
    </div>
  </div>
</div>
