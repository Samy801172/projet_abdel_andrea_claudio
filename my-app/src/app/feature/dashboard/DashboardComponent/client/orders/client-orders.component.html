<div class="orders-container">
  <h2>Mes Commandes</h2>

  @if (loading) {
    <div class="loading">Chargement des commandes...</div>
  }

  @if (error) {
    <div class="error">{{ error }}</div>
  }

  @if (!loading && !error) {
    @if (orders.length === 0) {
      <div class="empty-state">
        Vous n'avez pas encore de commande
      </div>
    } @else {
      <div class="orders-list">
        @for (order of orders; track order.id_order) {
          <div class="order-card">
            <div class="order-header">
              <span class="order-number">Commande #{{ order.id_order }}</span>
              <div class="order-info">
                <span class="order-date">{{ order.date_order | date:'dd/MM/yyyy' }}</span>
                <span class="status" [class]="getStatusClass(order.id_statut)">
                      {{ getStatusLabel(order.id_statut) }}
                    </span>
              </div>
            </div>

            @if (order.orderDetails && order.orderDetails.length > 0) {
              <div class="order-products">
                @for (detail of order.orderDetails; track detail.id_order_detail) {
                  <div class="product-item">
                    <span class="product-name">{{ detail.product.name }}</span>
                    <span class="product-quantity">x{{ detail.quantity }}</span>
                    <div class="price-info">
                      <span class="original-price">{{ detail.product.price | currency:'EUR' }}</span>
                      <span class="final-price">{{ detail.unit_price | currency:'EUR' }}</span>
                    </div>
                  </div>
                }
              </div>
            }

            <div class="order-footer">
              <div class="order-totals">
                    <span class="order-total">
                      Total: {{ order.montant_total | currency:'EUR' }}
                    </span>
              </div>
              <button class="details-btn" (click)="viewOrderDetails(order.id_order)">
                Voir le d√©tail
              </button>
            </div>
          </div>
        }
      </div>
    }
  }
</div>
